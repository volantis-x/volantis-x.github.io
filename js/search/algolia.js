let SearchService=(()=>{const e={};let t,a,i;return e.queryText=null,e.template='<div id="u-search">\n  <div class="modal">\n    <header class="modal-header" class="clearfix">\n      <button type="submit" id="u-search-modal-btn-submit" class="u-search-btn-submit">\n        <span class="fa-solid fa-search"></span>\n      </button>\n      <div id="algolia-search-input"></div>\n      <a id="u-search-btn-close" class="btn-close"> <span class="fa-solid fa-times"></span> </a>\n    </header>\n    <main class="modal-body">\n      <div id="algolia-search-results">\n        <div id="algolia-hits">\n          <div class="search-icon"><i class="fa-sharp fa-solid fa-telescope"></i></i></div>\n        </div>\n      </div>\n    </main>\n    <footer>\n      <div id="algolia-pagination"></div>\n      <hr>\n      <div id="algolia-info">\n        <div class="algolia-stats"></div>\n        <div class="algolia-poweredBy"></div>\n      </div>\n    </footer>\n  </div>\n  <div id="modal-overlay" class="modal-overlay"></div>\n  </div>\n  ',e.init=()=>{let t=document.createElement("div");t.innerHTML+=e.template,document.body.append(t),a=volantis.GLOBAL_CONFIG.search,a.appId&&a.apiKey&&a.indexName?(e.event(),e.setAlgolia()):(document.querySelector("#u-search main.modal-body").innerHTML="Algolia setting is invalid!",document.querySelector("#u-search main.modal-body").style.textAlign="center",document.querySelector("#u-search .modal").style.maxHeight="128px")},e.event=()=>{document.querySelector("#u-search-btn-close").addEventListener("click",e.close,!1),document.querySelector("#modal-overlay").addEventListener("click",e.close,!1),document.querySelectorAll(".u-search-form").forEach((t=>{t.addEventListener("submit",e.onSubmit,!1)})),document.querySelector("#algolia-search-input").addEventListener("input",(t=>{let a=t.target.querySelector(".ais-SearchBox-input");e.queryText=a?a.value:t.target.value}))},e.setAlgolia=()=>{t=instantsearch({indexName:a.indexName,searchClient:algoliasearch(a.appId,a.apiKey),searchFunction(e){e.state.query&&e.search()}});const n=instantsearch.widgets.configure({hitsPerPage:a.hitsPerPage}),s=instantsearch.widgets.searchBox({container:"#algolia-search-input",autofocus:!0,showReset:!1,showSubmit:!1,showLoadingIndicator:!1,searchAsYouType:a.searchAsYouType,placeholder:a.placeholder,templates:{input:"algolia-input"},queryHook(e,t){clearTimeout(i),i=setTimeout((()=>t(e)),500)}}),l=instantsearch.widgets.hits({container:"#algolia-hits",templates:{item(t){const a=e.queryText?`?keyword=${e.queryText}`:"",i=t.permalink?t.permalink:`${volantis.GLOBAL_CONFIG.root}${t.path}`,n=t._highlightResult,s=n.contentStripTruncate?e.cutContent(n.contentStripTruncate.value):n.contentStrip?e.cutContent(n.contentStrip.value):n.content?e.cutContent(n.content.value):"";return`\n            <a href="${i}${a}" class="result">\n            <span class="title">${n.title.value||"no-title"}</span>\n            <span class="digest">${s}</span>\n            </a>`},empty:function(e){return`<div id="resule-hits-empty"><i class="fa-solid fa-box-open"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\$\{query}/,e.query)}</p></div>`}}}),r=instantsearch.widgets.stats({container:"#algolia-info > .algolia-stats",templates:{text:function(e){return`${volantis.GLOBAL_CONFIG.languages.search.hits_stats.replace(/\$\{hits}/,e.nbHits).replace(/\$\{time}/,e.processingTimeMS)}`}}}),o=instantsearch.widgets.poweredBy({container:"#algolia-info > .algolia-poweredBy",theme:"dark"===volantis.dark?.mode?"dark":"light"}),c=instantsearch.widgets.pagination({container:"#algolia-pagination",totalPages:5,templates:{first:'<i class="fas fa-angle-double-left"></i>',last:'<i class="fas fa-angle-double-right"></i>',previous:'<i class="fas fa-angle-left"></i>',next:'<i class="fas fa-angle-right"></i>'}});t.addWidgets([n,s,l,r,o,c]),t.start()},e.setQueryText=i=>{e.queryText=i,t||e.init(),t?.setUiState({[a.indexName]:{query:i}})},e.search=()=>{document.querySelector("#u-search").style.display="block",document.addEventListener("keydown",(t=>{"Escape"===t.code&&e.close()}),{once:!0})},e.onSubmit=t=>{t.preventDefault();let a=t.target.querySelector(".u-search-input");e.setQueryText(a?.value?a.value:t.target.value),e.search()},e.cutContent=e=>{if(""===e)return"";const t=e.indexOf("<mark>");let a=t-30,i=t+120,n="",s="";return a<=0?(a=0,i=140):n="...",i>e.length?i=e.length:s="...",n+e.substring(a,i)+s},e.close=()=>{document.querySelector("#u-search").style.display="none"},{init:e.init,setQueryText:t=>{e.setQueryText(t)},search:e.search,close:e.close}})();Object.freeze(SearchService),SearchService.init();
//# sourceMappingURL=../../maps/js/search/algolia.js.map
