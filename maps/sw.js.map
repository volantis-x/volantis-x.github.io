{"version":3,"file":"../sw.js","names":["importScripts","workbox","setConfig","modulePathPrefix","core","precaching","routing","strategies","expiration","cacheableResponse","backgroundSync","CacheFirst","NetworkFirst","NetworkOnly","StaleWhileRevalidate","ExpirationPlugin","CacheableResponsePlugin","cacheSuffixVersion","maxEntries","self","addEventListener","event","waitUntil","caches","keys","then","Promise","all","map","key","includes","delete","setCacheNameDetails","prefix","suffix","skipWaiting","clientsClaim","cleanupOutdatedCaches","precacheAndRoute","url","revision","registerRoute","cacheName","fetchOptions","mode","credentials","plugins","maxAgeSeconds","purgeOnQuotaError","setDefaultHandler","networkTimeoutSeconds"],"sources":["sw.js"],"mappings":"AAAAA,cAAc,wEAEdC,QAAQC,UAAU,CACdC,iBAAkB,4DAGtB,MAAMC,KAAEA,KAAIC,WAAEA,WAAUC,QAAEA,QAAOC,WAAEA,WAAUC,WAAEA,WAAUC,kBAAEA,kBAAiBC,eAAEA,gBAAmBT,SAC3FU,WAAEA,WAAUC,aAAEA,aAAYC,YAAEA,YAAWC,qBAAEA,sBAAyBP,YAClEQ,iBAAEA,kBAAqBP,YACvBQ,wBAAEA,yBAA4BP,kBAE9BQ,mBAAqB,UACvBC,WAAa,IAEjBC,KAAKC,iBAAiB,YAAaC,IAC/BA,EAAMC,UACFC,OAAOC,OAAOC,MAAMD,GACTE,QAAQC,IAAIH,EAAKI,KAAKC,IACzB,IAAKA,EAAIC,SAPE,WAO4B,OAAOP,OAAOQ,OAAOF,EAAI,OAG3E,IAILzB,KAAK4B,oBAAoB,CACrBC,OAAQ,WACRC,OAhBuB,YAmB3B9B,KAAK+B,cACL/B,KAAKgC,eACL/B,WAAWgC,wBAMXhC,WAAWiC,iBACP,CACI,CAAEC,IAAK,iBAAkBC,SAAU,MACnC,CAAED,IAAK,iBAAkBC,SAAU,MACnC,CAAED,IAAK,aAAcC,SAAU,QAavClC,QAAQmC,cACJ,uBACA,IAAI9B,WAAW,CACX+B,UAAW,0BACXC,aAAc,CACVC,KAAM,OACNC,YAAa,QAEjBC,QAAS,CACL,IAAI/B,iBAAiB,CACjBgC,cAAe,OACfC,mBAAmB,QAOnC1C,QAAQmC,cACJ,wBACA,IAAI9B,WAAW,CACX+B,UAAW,0BACXC,aAAc,CACVC,KAAM,OACNC,YAAa,QAEjBC,QAAS,CACL,IAAI/B,iBAAiB,CACjBgC,cAAe,OACfC,mBAAmB,QAWnC1C,QAAQmC,cACJ,iBACA,IAAI5B,aAMRP,QAAQmC,cAEJ,+DACA,IAAI3B,sBAORR,QAAQmC,cAEJ,eAEA,IAAI3B,sBAORR,QAAQmC,cACJ,SACA,IAAI3B,sBAORR,QAAQ2C,kBACJ,IAAIrC,aAAa,CACbsC,sBAAuB","ignoreList":[],"sourcesContent":["importScripts('https://cdn.jsdelivr.net/npm/workbox-cdn@5.1.3/workbox/workbox-sw.js');\n\nworkbox.setConfig({\n    modulePathPrefix: 'https://cdn.jsdelivr.net/npm/workbox-cdn@5.1.3/workbox/'\n});\n\nconst { core, precaching, routing, strategies, expiration, cacheableResponse, backgroundSync } = workbox;\nconst { CacheFirst, NetworkFirst, NetworkOnly, StaleWhileRevalidate } = strategies;\nconst { ExpirationPlugin } = expiration;\nconst { CacheableResponsePlugin } = cacheableResponse;\n\nconst cacheSuffixVersion = '-000010', // 缓存版本号 极端重要，修改静态文件后发布网页一定要修改缓存版本号\n    maxEntries = 100;\n\nself.addEventListener('activate', (event) => {\n    event.waitUntil(\n        caches.keys().then((keys) => {\n            return Promise.all(keys.map((key) => {\n                if (!key.includes(cacheSuffixVersion)) return caches.delete(key);\n            }));\n        })\n    );\n});\n\n\ncore.setCacheNameDetails({\n    prefix: 'volantis', // 极端重要 自己拟定一个名字\n    suffix: cacheSuffixVersion\n});\n\ncore.skipWaiting();\ncore.clientsClaim();\nprecaching.cleanupOutdatedCaches();\n\n/*\n * Precache\n * - Static Assets\n */\nprecaching.precacheAndRoute( // 极端重要 定义首次缓存的静态文件\n    [\n        { url: '/css/first.css', revision: null },\n        { url: '/css/style.css', revision: null },\n        { url: '/js/app.js', revision: null },\n    ],\n);\n\n/*\n * Cache File From CDN\n *\n * Method: CacheFirst\n * cacheName: static-immutable\n * cacheTime: 30d\n */\n\n// cdn.jsdelivr.net - cors enabled\nrouting.registerRoute(\n    /.*cdn\\.jsdelivr\\.net/,\n    new CacheFirst({\n        cacheName: 'static-immutable' + cacheSuffixVersion,\n        fetchOptions: {\n            mode: 'cors',\n            credentials: 'omit'\n        },\n        plugins: [\n            new ExpirationPlugin({\n                maxAgeSeconds: 30 * 24 * 60 * 60,\n                purgeOnQuotaError: true\n            })\n        ]\n    })\n);\n\n// m7.music.126.net - cors enabled\nrouting.registerRoute(\n    /.*m7\\.music\\.126\\.net/,\n    new CacheFirst({\n        cacheName: 'static-immutable' + cacheSuffixVersion,\n        fetchOptions: {\n            mode: 'cors',\n            credentials: 'omit'\n        },\n        plugins: [\n            new ExpirationPlugin({\n                maxAgeSeconds: 30 * 24 * 60 * 60,\n                purgeOnQuotaError: true\n            })\n        ]\n    })\n);\n\n/*\n *  No Cache\n *\n * Method: networkOnly\n */\nrouting.registerRoute(\n    /.*baidu\\.com.*/,\n    new NetworkOnly()\n);\n/*\n * Others img fonts\n * Method: staleWhileRevalidate\n */\nrouting.registerRoute(\n    // Cache image fonts files\n    /.*\\.(?:png|jpg|jpeg|svg|gif|webp|ico|eot|ttf|woff|woff2|mp3)/,\n    new StaleWhileRevalidate()\n);\n\n/*\n * Static Assets\n * Method: staleWhileRevalidate\n */\nrouting.registerRoute(\n    // Cache CSS files\n    /.*\\.(css|js)/,\n    // Use cache but update in the background ASAP\n    new StaleWhileRevalidate()\n);\n\n/*\n * sw.js - Revalidate every time\n * staleWhileRevalidate\n */\nrouting.registerRoute(\n    '/sw.js', // 本文件名\n    new StaleWhileRevalidate()\n);\n\n/*\n * Default - Serve as it is\n * networkFirst\n */\nrouting.setDefaultHandler(\n    new NetworkFirst({\n        networkTimeoutSeconds: 3\n    })\n);\n"]}